t25fw_change_cat = ifelse(abs(t25fw_diff) < .2 * clean_T25FW_Avg_baseline,
'No Change',
ifelse(t25fw_diff > 0,
'Worsened',
'Improved')),
edss_change_cat = ifelse(clean_EDSS_baseline == 0 & edss_diff >= 1.5,
'Worsened',
ifelse(clean_EDSS_baseline >= 1.0 & clean_EDSS_baseline <=5.0 & edss_diff >= 1.0,
'Worsened',
ifelse(clean_EDSS_baseline >= 5.5 & edss_diff >= 0.5,
'Worsened',
'Other')))
)
zv_fw_base_yr1_df_wide <- zv_fw_base_yr1_df_wide %>%
mutate(delta_pix_worsenYN_cont = ifelse(delta_pix_change_cont == 'Worsened',
'Yes', 'No'),
stride_time_worsenYN_cont = ifelse(stride_time_change_cont == 'Worsened',
'Yes', 'No'),
either_pix_stride_worsenYN_cont = ifelse((delta_pix_change_cont == 'Worsened')|
(stride_time_change_cont == 'Worsened'),
'Yes', 'No'),
t25fw_worsenYN_cont = ifelse(t25fw_change_cont == 'Worsened',
'Yes', 'No'),
edss_worsenYN_cont = ifelse(edss_change_cont == 'Worsened',
'Yes', 'No'),
delta_pix_worsenYN_cat = ifelse(delta_pix_change_cat == 'Worsened',
'Yes', 'No'),
stride_time_worsenYN_cat = ifelse(stride_time_change_cat == 'Worsened',
'Yes', 'No'),
either_pix_stride_worsenYN_cat = ifelse((delta_pix_change_cat == 'Worsened') |
(stride_time_change_cat == 'Worsened'),
'Yes', 'No'),
t25fw_worsenYN_cat = ifelse(t25fw_change_cat == 'Worsened',
'Yes', 'No'),
edss_worsenYN_cat = ifelse(edss_change_cat == 'Worsened',
'Yes', 'No'))
write.csv(zv_fw_base_yr1_df_wide,
file.path(long_output_dir,
'fw_base_yer2_wide_groups.csv'))
print('t25fw_worsenYN_cont')
print(table(zv_fw_base_yr1_df_wide$t25fw_worsenYN_cont))
print('t25fw_worsenYN_cat')
print(table(zv_fw_base_yr1_df_wide$t25fw_worsenYN_cat))
print('edss_worsenYN_cont')
print(table(zv_fw_base_yr1_df_wide$edss_worsenYN_cont))
print('edss_worsenYN_cat')
print(table(zv_fw_base_yr1_df_wide$edss_worsenYN_cat))
print('delta_pix_worsenYN_cont')
print(table(zv_fw_base_yr1_df_wide$delta_pix_worsenYN_cont))
print('delta_pix_worsenYN_cat')
print(table(zv_fw_base_yr1_df_wide$delta_pix_worsenYN_cat))
print('stride_time_worsenYN_cont')
print(table(zv_fw_base_yr1_df_wide$stride_time_worsenYN_cont))
print('stride_time_worsenYN_cat')
print(table(zv_fw_base_yr1_df_wide$stride_time_worsenYN_cat))
print('either video metric cont')
print(table(zv_fw_base_yr1_df_wide$either_pix_stride_worsenYN_cont))
print('either video metric cat')
print(table(zv_fw_base_yr1_df_wide$either_pix_stride_worsenYN_cat))
add_video_vs_clinical_groups <- function(df, video_col, clinical_col, new_col_name) {
df[[new_col_name]] <- with(df, ifelse(df[[video_col]] == "Yes" & df[[clinical_col]] == "Yes", 'Both', # both
ifelse(df[[video_col]] == "No" & df[[clinical_col]] == "Yes", 'Clinical Only', # clinical only
ifelse(df[[video_col]] == "Yes"  & df[[clinical_col]] == "No", 'Video Only', # video only
'Neither')))) # neither
df[[new_col_name]] <- as.factor(df[[new_col_name]])
return(df)
}
# delta pixel
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'delta_pix_worsenYN_cont',
't25fw_worsenYN_cont',
't25fw_cont_vs_pixel_cont_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cont_vs_pixel_cont_groups)
# stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'stride_time_worsenYN_cont',
't25fw_worsenYN_cont',
't25fw_cont_vs_stride_cont_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cont_vs_stride_cont_groups)
# either pixel or stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'either_pix_stride_worsenYN_cont',
't25fw_worsenYN_cont',
't25fw_cont_vs_either_vid_cont_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cont_vs_either_vid_cont_groups)
# Delta pixel
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'delta_pix_worsenYN_cat',
't25fw_worsenYN_cat',
't25fw_cat_vs_pixel_cat_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cat_vs_pixel_cat_groups)
# Stride Time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'stride_time_worsenYN_cat',
't25fw_worsenYN_cat',
't25fw_cat_vs_stride_cat_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cat_vs_stride_cat_groups)
# either pixel or stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'either_pix_stride_worsenYN_cat',
't25fw_worsenYN_cat',
't25fw_cat_vs_either_vid_cat_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cat_vs_either_vid_cat_groups)
# pixel
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'delta_pix_worsenYN_cont',
'edss_worsenYN_cont',
'edss_cont_vs_pixel_cont_groups')
table(zv_fw_base_yr1_df_wide$edss_cont_vs_pixel_cont_groups)
# stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'stride_time_worsenYN_cont',
'edss_worsenYN_cont',
'edss_cont_vs_stride_cont_groups')
table(zv_fw_base_yr1_df_wide$edss_cont_vs_stride_cont_groups)
# either pixel or stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'either_pix_stride_worsenYN_cont',
'edss_worsenYN_cont',
'edss_cont_vs_either_vid_cont_groups')
table(zv_fw_base_yr1_df_wide$edss_cont_vs_either_vid_cont_groups)
# pixel
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'delta_pix_worsenYN_cat',
'edss_worsenYN_cat',
'edss_cat_vs_pixel_cat_groups')
table(zv_fw_base_yr1_df_wide$edss_cat_vs_pixel_cat_groups)
# stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'stride_time_worsenYN_cat',
'edss_worsenYN_cat',
'edss_cat_vs_stride_cat_groups')
table(zv_fw_base_yr1_df_wide$edss_cat_vs_pixel_cat_groups)
# either pixel or stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'either_pix_stride_worsenYN_cat',
'edss_worsenYN_cat',
'edss_cat_vs_either_vid_cat_groups')
table(zv_fw_base_yr1_df_wide$edss_cat_vs_either_vid_cat_groups)
# delta pixel
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'delta_pix_worsenYN_cont',
't25fw_worsenYN_cat',
't25fw_cat_vs_pixel_cont_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cat_vs_pixel_cont_groups)
# stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'stride_time_worsenYN_cont',
't25fw_worsenYN_cat',
't25fw_cat_vs_stride_cont_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cat_vs_stride_cont_groups)
# either
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'either_pix_stride_worsenYN_cont',
't25fw_worsenYN_cat',
't25fw_cat_vs_either_vid_cont_groups')
table(zv_fw_base_yr1_df_wide$t25fw_cat_vs_either_vid_cont_groups)
# pixel
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'delta_pix_worsenYN_cont',
'edss_worsenYN_cat',
'edss_cat_vs_pixel_cont_groups')
table(zv_fw_base_yr1_df_wide$edss_cat_vs_pixel_cont_groups)
# stride time
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'stride_time_worsenYN_cont',
'edss_worsenYN_cat',
'edss_cat_vs_stride_cont_groups')
table(zv_fw_base_yr1_df_wide$edss_cat_vs_stride_cont_groups)
# either
zv_fw_base_yr1_df_wide <- add_video_vs_clinical_groups(zv_fw_base_yr1_df_wide,
'either_pix_stride_worsenYN_cont',
'edss_worsenYN_cat',
'edss_cat_vs_either_vid_cont_groups')
table(zv_fw_base_yr1_df_wide$edss_cat_vs_either_vid_cont_groups)
# convert to long dataframe
plot_long_df <- zv_fw_base_yr1_df_wide %>%
select(c(bw_id, ends_with('groups'))) %>%
pivot_longer(cols = ends_with('groups'),
names_to = 'cols_compared',
values_to = 'agreement_group') %>%
mutate(clinical_outcome = ifelse(grepl("t25fw_cont", cols_compared),
'T25FW Continuous',
ifelse(grepl("t25fw_cat", cols_compared),
'T25FW Categorical',
ifelse(grepl('edss_cont', cols_compared),
'EDSS Ordinal',
ifelse(grepl('edss_cat', cols_compared),
'EDSS Categorical',
'Other'))))) %>%   # add column for outcome
mutate(video_metric = ifelse(grepl('pixel_cont', cols_compared),
'Pixel Proxy Continuous',
ifelse(grepl('pixel_cat', cols_compared),
'Pixel Proxy Categorical',
ifelse(grepl('stride_cont', cols_compared),
'Stride Time Continuous',
ifelse(grepl('stride_cat', cols_compared),
'Stride Time Categorical',
ifelse(grepl('either_vid_cont', cols_compared),
'Either Continuous',
ifelse(grepl('either_vid_cat', cols_compared),
'Either Categorical',
'Other'))))))) # add column for video metric
# factor: agreement_group
plot_long_df$agreement_group <- factor(plot_long_df$agreement_group,
levels = c('Video Only',
'Clinical Only',
'Both',
'Neither'),
labels = c('Video metric only',
'Clinical outcome only',
'Both',
'Neither'))
# Plot all
ggplot(data = plot_long_df, aes(x = video_metric, fill = agreement_group)) +
geom_bar(position = 'fill') +
facet_grid(rows = vars(clinical_outcome)) +
scale_fill_brewer(name = 'Worsened by:', palette = "Set2") +
labs(y = "Proportion", x = "") +
theme_minimal() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle = 90),
strip.text.y.right = element_text(angle = 0))
exclude_strings <- c('edss_cont_vs_pixel_cat_groups',
'edss_cont_vs_stride_cat_groups',
"t25fw_cont_vs_pixel_cat_groups",
't25fw_cont_vs_stride_cat_groups'
)
plot_long_df_2 <- plot_long_df %>%
filter(!grepl(paste(exclude_strings, collapse="|"), cols_compared))
# make new columns
# only comparing stride time categorical and pixel categorical to T25FW categorical
# same for continuou
# don't need to specificy categorical or continuous on plot
plot_long_df_2 <- plot_long_df_2 %>%
mutate(video_metric_simple = ifelse(grepl('Pixel Proxy', video_metric),
'Pixel Proxy',
ifelse(grepl('Stride Time', video_metric),
'Stride Time',
ifelse(grepl('Either', video_metric),
'Either', 'Other'))))
plot_long_df_2$video_metric_simple = factor(plot_long_df_2$video_metric_simple,
levels = c('Pixel Proxy',
'Stride Time',
'Either'))
print(table(plot_long_df_2$clinical_outcome, plot_long_df_2$video_metric)) # confirm
# factor clinical outcome variable - control order of facet_wrap
plot_long_df_2$clinical_outcome <- factor(plot_long_df_2$clinical_outcome,
levels = c('T25FW Continuous',
'T25FW Categorical',
'EDSS Ordinal',
'EDSS Categorical'))
ggplot(data = plot_long_df_2, aes(x = video_metric_simple, fill = agreement_group)) +
geom_bar(position = 'fill') +
facet_wrap(~clinical_outcome) +
scale_fill_brewer(name = 'Worsened by:', palette = "Set2") +
labs(y = "Proportion", x = "Video Metric") +
theme_minimal() +
theme(legend.position = 'bottom')
# add proportion column to put text on plot
plot_long_df_2_prop <- plot_long_df_2 %>%
group_by(clinical_outcome, video_metric_simple, agreement_group) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(clinical_outcome, video_metric_simple) %>%
mutate(prop = n / sum(n),
label = scales::percent(prop, accuracy = 1))
# proportion
p <- ggplot(plot_long_df_2_prop, aes(x = video_metric_simple, y = prop, fill = agreement_group)) +
geom_bar(stat = "identity", position = "fill", width = 0.5) +
geom_text(aes(label = ifelse(prop > 0.03, label, "")),  # Only label if > 5%
position = position_fill(vjust = 0.5),
size = 3.25) +
facet_wrap(~ clinical_outcome) +
scale_fill_brewer(name = "Worsened by:", palette = "Set2") +
labs(y = "Proportion", x = "") +
theme_minimal() +
theme(plot.title = element_text(size = 9, face = 'bold', hjust = 0.5),
axis.title = element_text(size = 9),
#axis.text = element_text(size = 9),
axis.text.x = element_text(size = 9, face = 'italic'),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
legend.text = element_text(size = 9),
legend.title = element_text(size = 9),
legend.position = 'bottom',
legend.key.size = unit(0.5, "lines"))
p
ggsave(file.path(long_output_dir, 'barcharts_proportion_1.png'),
bg = 'white', height = 5, width = 5)
# check - agreement between EDSS and T25FW categorical change?
head(zv_fw_base_yr1_df_wide)
#  check - agreement between EDSS and T25FW categorical change?
# do participants worsen in both?
table(zv_fw_base_yr1_df_wide$t25fw_change_cat)
table(zv_fw_base_yr1_df_wide$edss_change_cat)
# worsened by both edss and t25FW
both_df <- zv_fw_base_yr1_df_wide %>%
filter(t25fw_change_cat == 'Worsened' & edss_change_cat == 'Worsened')
both_df
edss_df <- zv_fw_base_yr1_df_wide %>%
filter(edss_change_cat == 'Worsened')
edss_df %>% select(bw_id, clean_EDSS_baseline,
clean_EDSS_year2,
delta_pix_change_cont,
stride_time_change_cont)
# categorical worsening by EDSS only for people with EDSS < 4 at both visits - expect much affect on walking?
# T25FW categorical
t25fw_df <- zv_fw_base_yr1_df_wide %>%
filter(t25fw_change_cat == 'Worsened')
t25fw_df %>% select(bw_id, clean_T25FW_Avg_baseline,
clean_T25FW_Avg_year2,
delta_pix_change_cont,
stride_time_change_cont)
table(zv_fw_base_yr1_df_wide$delta_pix_change_cont,
zv_fw_base_yr1_df_wide$t25fw_change_cat)
table(zv_fw_base_yr1_df_wide$delta_pix_worsenYN_cont,
zv_fw_base_yr1_df_wide$t25fw_worsenYN_cat)
table(zv_fw_base_yr1_df_wide$stride_time_change_cont,
zv_fw_base_yr1_df_wide$t25fw_change_cat)
table(zv_fw_base_yr1_df_wide$stride_time_worsenYN_cont,
zv_fw_base_yr1_df_wide$t25fw_worsenYN_cat)
table(zv_fw_base_yr1_df_wide$delta_pix_change_cont,
zv_fw_base_yr1_df_wide$edss_change_cat)
table(zv_fw_base_yr1_df_wide$delta_pix_worsenYN_cont,
zv_fw_base_yr1_df_wide$edss_worsenYN_cat)
table(zv_fw_base_yr1_df_wide$stride_time_change_cont,
zv_fw_base_yr1_df_wide$edss_change_cat)
table(zv_fw_base_yr1_df_wide$stride_time_worsenYN_cont,
zv_fw_base_yr1_df_wide$edss_worsenYN_cat)
include_strings <- c('edss_cat_vs_either_vid_cont_groups',
'edss_cat_vs_pixel_cont_groups',
"edss_cat_vs_stride_cont_groups",
't25fw_cat_vs_either_vid_cont_groups',
't25fw_cat_vs_pixel_cont_groups',
"t25fw_cat_vs_stride_cont_groups"
)
plot_long_df_3 <- plot_long_df %>%
filter(grepl(paste(include_strings, collapse="|"), cols_compared))
table(plot_long_df_3$cols_compared)
# add proportion column to put text on plot
plot_long_df_3_prop <- plot_long_df_3 %>%
group_by(clinical_outcome, video_metric, agreement_group) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(clinical_outcome, video_metric) %>%
mutate(prop = n / sum(n),
label = scales::percent(prop, accuracy = 1))
# proportion
p <- ggplot(plot_long_df_3_prop, aes(x = video_metric, y = prop, fill = agreement_group)) +
geom_bar(stat = "identity", position = "fill", width = 0.5) +
geom_text(aes(label = ifelse(prop > 0.03, label, "")),  # Only label if > 5%
position = position_fill(vjust = 0.5),
size = 3.25) +
facet_wrap(~ clinical_outcome) +
scale_fill_brewer(name = "Worsened by:", palette = "Set2") +
labs(y = "Proportion", x = "") +
theme_minimal() +
theme(plot.title = element_text(size = 9, face = 'bold', hjust = 0.5),
axis.title = element_text(size = 9),
#axis.text = element_text(size = 9),
axis.text.x = element_text(size = 9, face = 'italic', angle = 90),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
legend.text = element_text(size = 9),
legend.title = element_text(size = 9),
legend.position = 'bottom',
legend.key.size = unit(0.5, "lines"))
p
ggsave(file.path(long_output_dir, 'barcharts_proportion_2.png'),
bg = 'white', height = 5, width = 5)
# load all FW data
fw_clean_data_path <- file.path("C:/Users/mmccu/Box/MM_Personal/5_Projects/BoveLab/3_Data_and_Code/gait_bw_zeno_home_analysis",
analysis_version,
"000_merged_cleaned_data",
"zv_bw_merged_gait_vertical_FW_1_clean.csv")
zv_fw_clean_all_df <- read.csv(fw_clean_data_path)
zv_fw_clean_df <- zv_fw_clean_all_df %>%
drop_na(c("stride_time_median_sec_pose_zv",
"delta_pix_h_rel_median_pose_zv",
"mean_cadence_step_per_min_pose_zv",
"stride_width_median_cm_pose_zv"))
#"stance_time_sec_std_pose_zv",
# "swing_time_sec_std_pose_zv"))
# filter(!is.na(delta_pix_h_rel_median_pose_zv) & !is.na(stride_time_median_sec_pose_zv))
nrow(zv_fw_clean_df)
zv_fw_clean_df <- zv_fw_clean_all_df %>%
drop_na(c("stride_time_median_sec_pose_zv",
"delta_pix_h_rel_median_pose_zv",
"mean_cadence_step_per_min_pose_zv",
"stride_width_median_cm_pose_zv"))
#"stance_time_sec_std_pose_zv",
# "swing_time_sec_std_pose_zv"))
# filter(!is.na(delta_pix_h_rel_median_pose_zv) & !is.na(stride_time_median_sec_pose_zv))
nrow(zv_fw_clean_df)
plot(zv_fw_clean_df$delta_pix_h_rel_median_pose_zv,
zv_fw_clean_df$clean_T25FW_Avg)
plot(log(zv_fw_clean_df$delta_pix_h_rel_median_pose_zv),
log(zv_fw_clean_df$clean_T25FW_Avg))
zv_fw_clean_df$log_delta_pixel_median <- log(zv_fw_clean_df$delta_pix_h_rel_median_pose_zv)
# pixel stride time cadence
pca_pix_stride_cadence <- prcomp(~ log_delta_pixel_median +
stride_time_median_sec_pose_zv,
mean_cadence_step_per_min_pose_zv,
data = zv_fw_clean_df,
scale = TRUE)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
# PC1 - faster change in pixel height and shorter stride times (think higher value in this = faster walking??); decreased pc1 = worsening in walking
biplot(pca_pix_stride_cadence)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
# PC1 - faster change in pixel height and shorter stride times (think higher value in this = faster walking??); decreased pc1 = worsening in walking
biplot(pca_pix_stride_cadence)
pca_pix_stride_cadence <- prcomp(~ log_delta_pixel_median +
stride_time_median_sec_pose_zv,
mean_cadence_step_per_min_pose_zv,
data = zv_fw_clean_df,
scale = TRUE)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
# PC1 - faster change in pixel height and shorter stride times (think higher value in this = faster walking??); decreased pc1 = worsening in walking
biplot(pca_pix_stride_cadence)
pca_pix_stride_cadence <- prcomp(~ log_delta_pixel_median +
stride_time_median_sec_pose_zv +
mean_cadence_step_per_min_pose_zv,
data = zv_fw_clean_df,
scale = TRUE)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
biplot(pca_pix_stride_cadence)
# pixel stride time cadence
pca_pix_stride_cadence <- prcomp(~ log_delta_pixel_median +
stride_time_median_sec_pose_zv +
mean_cadence_step_per_min_pose_zv,
data = zv_fw_clean_df,
scale = TRUE)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
biplot(pca_pix_stride_cadence)
# add to df
pca_scores_test <- pca_pix_stride_cadence$x
zv_fw_clean_wPCs_test <- cbind(zv_fw_clean_df, pca_scores_test)
head(zv_fw_clean_wPCs_test)
# pixel stride time cadence
pca_pix_stride_cadence <- prcomp(~ log_delta_pixel_median +
stride_time_median_sec_pose_zv +
mean_cadence_step_per_min_pose_zv,
data = zv_fw_clean_df,
scale = TRUE)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
biplot(pca_pix_stride_cadence)
# add to df
pca_scores_test <- pca_pix_stride_cadence$x
zv_fw_clean_wPCs_test <- cbind(zv_fw_clean_df, pca_scores_test)
head(zv_fw_clean_wPCs_test)
## plot vs T25FW
# original T25FW data
plot(zv_fw_clean_wPCs_test$clean_T25FW_Avg,
zv_fw_clean_wPCs_test$PC1)
cor.test(zv_fw_clean_wPCs_test$clean_T25FW_Avg,
zv_fw_clean_wPCs_test$PC1,
method=c("spearman")) # non-parametric
plot(zv_fw_clean_wPCs_test$log_t25fw,
zv_fw_clean_wPCs_test$PC1)
zv_fw_clean_wPCs_test$log_t25fw <- log(zv_fw_clean_wPCs_test$clean_T25FW_Avg)
plot(zv_fw_clean_wPCs_test$log_t25fw,
zv_fw_clean_wPCs_test$PC1)
summary(lme_log_results_test)
# regression
# log T25FW + age
lme_log_results_test <- lmer(log_t25fw ~ PC1 + clean_Age
+ (1|bw_id),
data = zv_fw_clean_wPCs_test,
REML = FALSE)
library(lme4)
library(lmerTest)
library(performance)
# pixel stride time cadence
pca_pix_stride_cadence <- prcomp(~ log_delta_pixel_median +
stride_time_median_sec_pose_zv +
mean_cadence_step_per_min_pose_zv,
data = zv_fw_clean_df,
scale = TRUE)
summary(pca_pix_stride_cadence)
pca_pix_stride_cadence$rotation
biplot(pca_pix_stride_cadence)
# add to df
pca_scores_test <- pca_pix_stride_cadence$x
zv_fw_clean_wPCs_test <- cbind(zv_fw_clean_df, pca_scores_test)
head(zv_fw_clean_wPCs_test)
## plot vs T25FW
# original T25FW data
plot(zv_fw_clean_wPCs_test$clean_T25FW_Avg,
zv_fw_clean_wPCs_test$PC1)
cor.test(zv_fw_clean_wPCs_test$clean_T25FW_Avg,
zv_fw_clean_wPCs_test$PC1,
method=c("spearman")) # non-parametric
zv_fw_clean_wPCs_test$log_t25fw <- log(zv_fw_clean_wPCs_test$clean_T25FW_Avg)
plot(zv_fw_clean_wPCs_test$log_t25fw,
zv_fw_clean_wPCs_test$PC1)
# regression
# log T25FW + age
lme_log_results_test <- lmer(log_t25fw ~ PC1 + clean_Age
+ (1|bw_id),
data = zv_fw_clean_wPCs_test,
REML = FALSE)
summary(lme_log_results_test)
hist(residuals(lme_log_results_test))
r2(lme_log_results_test)$R2_conditional
r2(lme_log_results_test)$R2_marginal
